From ae92c935e51b9d2a530558e349c068c207d74051 Mon Sep 17 00:00:00 2001
From: Brett Witherspoon <spoonb@exherbo.org>
Date: Tue, 1 Feb 2011 19:56:24 -0600
Subject: [PATCH] configure: don't install systemd unit with --without-systemdsystemunitdir
Upstream: Submitted, https://bugs.freedesktop.org/show_bug.cgi?id=33828
---
 configure.ac |   11 ++++++++---
 1 files changed, 8 insertions(+), 3 deletions(-)

diff --git a/configure.ac b/configure.ac
index 8314837..9d22e3c 100644
--- a/configure.ac
+++ b/configure.ac
@@ -161,9 +161,14 @@ AC_PATH_PROG([XSLTPROC], [xsltproc])
 AC_ARG_WITH([systemdsystemunitdir],
         AS_HELP_STRING([--with-systemdsystemunitdir=DIR], [Directory for systemd service files]),
         [],
-        [with_systemdsystemunitdir=$($PKG_CONFIG --variable=systemdsystemunitdir systemd)])
-AC_SUBST([systemdsystemunitdir], [$with_systemdsystemunitdir])
-AM_CONDITIONAL(HAVE_SYSTEMD, [test -n "$with_systemdsystemunitdir"])
+        [with_systemdsystemunitdir=yes])
+if test "x$with_systemdsystemunitdir" = "xyes"; then
+    with_systemdsystemunitdir=$($PKG_CONFIG --variable=systemdsystemunitdir systemd)
+fi
+if test "x$with_systemdsystemunitdir" != "xno"; then
+    AC_SUBST([systemdsystemunitdir], [$with_systemdsystemunitdir])
+fi
+AM_CONDITIONAL(HAVE_SYSTEMD, [test -n "$with_systemdsystemunitdir" -a "x$with_systemdsystemunitdir" != "xno" ])
 
 AC_CONFIG_HEADERS([config.h])
 AC_CONFIG_FILES([
-- 
1.7.4

