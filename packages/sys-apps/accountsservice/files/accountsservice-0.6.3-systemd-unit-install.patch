From b0f554227c6933cc572431b6420bf443554294b9 Mon Sep 17 00:00:00 2001
From: Brett Witherspoon <spoonb@exherbo.org>
Date: Tue, 1 Feb 2011 19:56:24 -0600
Subject: [PATCH] configure: don't install systemd unit with --without-systemdsystemunitdir
Upstream: Submitted, https://bugs.freedesktop.org/show_bug.cgi?id=33828

---
 configure.ac |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/configure.ac b/configure.ac
index 8314837..c91a3b4 100644
--- a/configure.ac
+++ b/configure.ac
@@ -162,8 +162,10 @@ AC_ARG_WITH([systemdsystemunitdir],
         AS_HELP_STRING([--with-systemdsystemunitdir=DIR], [Directory for systemd service files]),
         [],
         [with_systemdsystemunitdir=$($PKG_CONFIG --variable=systemdsystemunitdir systemd)])
-AC_SUBST([systemdsystemunitdir], [$with_systemdsystemunitdir])
-AM_CONDITIONAL(HAVE_SYSTEMD, [test -n "$with_systemdsystemunitdir"])
+if test "x$with_systemdsystemunitdir" != xno; then
+    AC_SUBST([systemdsystemunitdir], [$with_systemdsystemunitdir])
+fi
+AM_CONDITIONAL(HAVE_SYSTEMD, [test -n "$with_systemdsystemunitdir" -a "x$with_systemdsystemunitdir" != xno ])
 
 AC_CONFIG_HEADERS([config.h])
 AC_CONFIG_FILES([
-- 
1.7.4

