# Copyright 2007 Bryan Ã˜stergaard <kloeri@exherbo.org>
# Copyright 2008 Saleem Abdulrasool <compnerd@compnerd.org>
# Distributed under the terms of the GNU General Public License v2

require glib multilib

SLOT="2"
PLATFORMS="~amd64 ~ia64 ~ppc64 ~x86"
MYOPTIONS="doc fam man-pages"

DEPENDENCIES="
    build:
        sys-devel/gettext[>=0.11]
        dev-util/pkg-config[>=0.16]
        doc? ( dev-doc/gtk-doc[>=1.11] )
        man-pages? ( dev-libs/libxslt
                     app-text/docbook-xml-dtd:4.1.2 )
    build+run:
        fam? ( app-admin/gamin )
    post,suggested:
        dev-util/desktop-file-utils [[ description = [ Needed to run the testsuite, see #172 ] ]]
        gnome-desktop/gvfs
"

DEFAULT_SRC_CONFIGURE_PARAMS=( '--enable-static' '--with-threads=posix' )
DEFAULT_SRC_CONFIGURE_OPTION_ENABLES=( 'doc gtk-doc' 'fam' 'man-pages man' )

src_test() {
    if ! has_version dev-util/desktop-file-utils ; then
        ewarn "${PNV} tests need dev-utils/desktop-file-utils to succeed, skipping testsuite"
        return
    fi

    default
}

src_install() {
    default

    keepdir "/usr/$(get_libdir)/gio/modules"
}

